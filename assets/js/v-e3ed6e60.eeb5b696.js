(self.webpackChunkgordan404wiki=self.webpackChunkgordan404wiki||[]).push([[5818],{6674:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-e3ed6e60",path:"/vueAnalysis/component/createComponent.html",title:"createComponent",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[],filePathRelative:"vueAnalysis/component/createComponent.md",git:{updatedTime:1626972344e3,contributors:[{name:"lishuaixingNewBee",email:"vae.china@foxmail.com",commits:1}]}}},4493:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>X});var t=a(4057);const o=a.p+"assets/img/vdom-hooks.f707acc2.png",e=(0,t.Wm)("h1",{id:"createcomponent",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#createcomponent","aria-hidden":"true"},"#"),(0,t.Uk)(" createComponent")],-1),c=(0,t.Wm)("p",null,[(0,t.Uk)("在前面介绍"),(0,t.Wm)("code",null,"createElement"),(0,t.Uk)("方法的过程中，我们提到过有两处都调用了"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("方法，在这一节我们来详细分析一下"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("方法的实现逻辑。")],-1),p=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("是定义在"),(0,t.Wm)("code",null,"src/core/vmode/create-component.js"),(0,t.Uk)("文件中的，其代码如下：")],-1),k=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"createComponent"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("Ctor"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" Class"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("Component"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"|"),(0,t.Uk)(" Function "),(0,t.Wm)("span",{class:"token operator"},"|"),(0,t.Uk)(" Object "),(0,t.Wm)("span",{class:"token operator"},"|"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  data"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)("VNodeData"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  context"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" Component"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  children"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)("Array"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("VNode"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  tag"),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" string")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" VNode "),(0,t.Wm)("span",{class:"token operator"},"|"),(0,t.Uk)(" Array"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("VNode"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"|"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// ...省略其它"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" baseCtor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" context"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("$options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_base\n  "),(0,t.Wm)("span",{class:"token comment"},"// plain options object: turn it into a constructor"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token function"},"isObject"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Ctor"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    Ctor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" baseCtor"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"extend"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Ctor"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  data "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" data "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token comment"},"// resolve constructor options in case global mixins are applied after"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// component constructor creation"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"resolveConstructorOptions"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Ctor"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token comment"},"// install component management hooks onto the placeholder node"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"installComponentHooks"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token comment"},"// return a placeholder vnode"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" name "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Ctor"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(" tag\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"VNode"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token template-string"},[(0,t.Wm)("span",{class:"token template-punctuation string"},"`"),(0,t.Wm)("span",{class:"token string"},"vue-component-"),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("Ctor"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("cid"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("name "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token template-string"},[(0,t.Wm)("span",{class:"token template-punctuation string"},"`"),(0,t.Wm)("span",{class:"token string"},"-"),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token template-punctuation string"},"`")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"''"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token template-punctuation string"},"`")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    data"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"undefined"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"undefined"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"undefined"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" context"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" Ctor"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" propsData"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" listeners"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" tag"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" children "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    asyncFactory\n  "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// ...省略其它"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" vnode\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),u=(0,t.Wm)("p",null,[(0,t.Uk)("因为"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("方法要实现的功能点有很多，以上是我们的精简代码，其中被精简掉的代码有："),(0,t.Wm)("strong",null,"组件检验相关"),(0,t.Uk)("、"),(0,t.Wm)("strong",null,"异步组件相关"),(0,t.Uk)("、"),(0,t.Wm)("strong",null,"获取prosData相关"),(0,t.Uk)("、"),(0,t.Wm)("strong",null,"抽象组件相关"),(0,t.Uk)("以及"),(0,t.Wm)("strong",null,"weex相关"),(0,t.Uk)("。")],-1),l=(0,t.Wm)("p",null,[(0,t.Uk)("在分析"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("方法的时候，我们主要关注两个方面的内容："),(0,t.Wm)("strong",null,"构造子类构造函数"),(0,t.Uk)("和"),(0,t.Wm)("strong",null,"安装组件钩子函数"),(0,t.Uk)("。至于最后的创建组件"),(0,t.Wm)("code",null,"VNode"),(0,t.Uk)("并返回"),(0,t.Wm)("code",null,"VNode"),(0,t.Uk)("，则是最简单的，在这一步我们只需要知道创建组件"),(0,t.Wm)("code",null,"VNode"),(0,t.Uk)("的时候，向"),(0,t.Wm)("code",null,"VNode"),(0,t.Uk)("构造函数传递的第三个参数"),(0,t.Wm)("code",null,"children"),(0,t.Uk)("为"),(0,t.Wm)("code",null,"undefined"),(0,t.Uk)("，也就是说组件"),(0,t.Wm)("code",null,"VNode"),(0,t.Uk)("没有"),(0,t.Wm)("code",null,"children"),(0,t.Uk)("子节点，因为其值为"),(0,t.Wm)("code",null,"undefined"),(0,t.Uk)("。")],-1),m=(0,t.Wm)("p",null,"代码分析：",-1),W=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"构造子类构造函数"),(0,t.Uk)("：在代码最开始，首先通过"),(0,t.Wm)("code",null,"$options._base"),(0,t.Uk)("拿到基础构造函数，这个基础构造函数也就是大"),(0,t.Wm)("code",null,"Vue"),(0,t.Uk)("的构造函数，"),(0,t.Wm)("code",null,"$options._base"),(0,t.Uk)("赋值过程是在"),(0,t.Wm)("code",null,"initGlobalAPI"),(0,t.Uk)("函数执行的过程中赋值的。")])],-1),i=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"initGlobalAPI"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"Vue"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  Vue"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_base "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Vue\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),r=(0,t.Wm)("p",null,[(0,t.Uk)("根据我们之前介绍的规则，我们在"),(0,t.Wm)("code",null,"options"),(0,t.Uk)("上的属性，可以在后续通过"),(0,t.Wm)("code",null,"$options"),(0,t.Uk)("拿到，这是因为在"),(0,t.Wm)("code",null,"this._init"),(0,t.Uk)("方法的执行过程中，进行了"),(0,t.Wm)("code",null,"mergeOptions"),(0,t.Uk)("配置合并。")],-1),U=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("vm"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("$options "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"mergeOptions"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"resolveConstructorOptions"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("vm"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("constructor"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  options "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  vm\n"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])])],-1),d=(0,t.Wm)("p",null,[(0,t.Uk)("我们再来看一下"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("的第一个参数，以"),(0,t.Wm)("code",null,"App.vue"),(0,t.Uk)("组件为例：")],-1),g=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" HelloWorld "),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'@/components/HelloWorld.vue'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'App'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"data"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      msg"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'message'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      age"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"23"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      list"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  components"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    HelloWorld\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),f=(0,t.Wm)("p",null,[(0,t.Uk)("我们在"),(0,t.Wm)("code",null,"App.vue"),(0,t.Uk)("组件中"),(0,t.Wm)("code",null,"export"),(0,t.Uk)("导出的是一个对象，其中对象定义了"),(0,t.Wm)("code",null,"name"),(0,t.Uk)("、"),(0,t.Wm)("code",null,"data"),(0,t.Uk)("以及"),(0,t.Wm)("code",null,"components"),(0,t.Uk)("三个属性，那么"),(0,t.Wm)("code",null,"Ctor"),(0,t.Uk)("参数就应该是这个对象，但当我们真实调试的时候却发现"),(0,t.Wm)("code",null,"Ctor"),(0,t.Uk)("属性比我们想象的还要多，这是因为"),(0,t.Wm)("code",null,"vue-loader"),(0,t.Uk)("在处理"),(0,t.Wm)("code",null,".vue"),(0,t.Uk)("文件的时候默认帮我们做了一些处理，以下是"),(0,t.Wm)("code",null,"App.vue"),(0,t.Uk)("真实调试时的"),(0,t.Wm)("code",null,"Ctor"),(0,t.Uk)("参数：")],-1),y=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" Ctor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  beforeCreate"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  beforeDestroy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  components"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    HelloWorld\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"data"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      msg"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'message'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      age"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"23"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      list"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'App'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"render"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  staticRenderFns"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  __file"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./App.vue'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  _compiled"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),b=(0,t.Wm)("p",null,[(0,t.Uk)("接下来，我们来看一下"),(0,t.Wm)("code",null,"baseCtor.extend"),(0,t.Uk)("，全局的"),(0,t.Wm)("code",null,"extend"),(0,t.Uk)("方法的定义位置我们已经在之前介绍过了，它是在"),(0,t.Wm)("code",null,"initGlobalAPI"),(0,t.Uk)("方法中调用"),(0,t.Wm)("code",null,"initExtend"),(0,t.Uk)("时被定义的，其中"),(0,t.Wm)("code",null,"initExtend"),(0,t.Uk)("定义在"),(0,t.Wm)("code",null,"src/core/global-api/extend.js"),(0,t.Uk)("文件中，代码如下：")],-1),w=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"initExtend"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("Vue"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" GlobalAPI")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  Vue"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("cid "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cid "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Uk)("\n\n  Vue"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"extend"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("extendOptions"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" Object")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" Function "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    extendOptions "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" extendOptions "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" Super "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" SuperId "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("cid\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" cachedCtors "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" extendOptions"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_Ctor "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("extendOptions"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_Ctor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("cachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" cachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" name "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" extendOptions"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("process"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("env"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token constant"},"NODE_ENV"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"!=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" name"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"validateComponentName"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"Sub"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"VueComponent"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"options"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"_init"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("constructor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("cid "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" cid"),(0,t.Wm)("span",{class:"token operator"},"++"),(0,t.Uk)("\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"mergeOptions"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n      Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      extendOptions\n    "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'super'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// For props and computed properties, we define the proxy getters on"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// the Vue instances at extension time, on the extended prototype. This"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// avoids Object.defineProperty calls for each instance created."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"initProps"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Sub"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("computed"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"initComputed"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("Sub"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// allow further extension/mixin/plugin usage"),(0,t.Uk)("\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("extend "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("extend\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("mixin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("mixin\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("use "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("use\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// create asset registers, so extended classes"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// can have their private assets too."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token constant"},"ASSET_TYPES"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"forEach"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"type"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      Sub"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("type"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("type"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// enable recursive self-lookup"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("components"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// keep a reference to the super options at extension time."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// later at instantiation we can check if Super's options have"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// been updated."),(0,t.Uk)("\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("superOptions "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("extendOptions "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" extendOptions\n    Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("sealedOptions "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"extend"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// cache constructor"),(0,t.Uk)("\n    cachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" Sub\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),v=(0,t.Wm)("p",null,[(0,t.Uk)("我们看一下"),(0,t.Wm)("code",null,"Vue.extend"),(0,t.Uk)("方法最核心的几段代码：")],-1),h=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" Super "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"Sub"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"VueComponent"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"options"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"_init"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("constructor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n")])])],-1),x=(0,t.Wm)("p",null,[(0,t.Uk)("在"),(0,t.Wm)("code",null,"extend"),(0,t.Uk)("方法中，使用了非常经典的寄生组合继承的方式，来让"),(0,t.Wm)("code",null,"Sub"),(0,t.Uk)("子类去继承父类的属性和方法。在原型继承之前，首先调用了"),(0,t.Wm)("code",null,"this._init"),(0,t.Uk)("方法，这个方法的逻辑我们在之前已经提到过了，这里就不再累述。原型继承后，"),(0,t.Wm)("code",null,"Sub"),(0,t.Uk)("子类就拥有了"),(0,t.Wm)("code",null,"Super"),(0,t.Uk)("父类全部的属性和方法，例如：")],-1),S=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"Super"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Super'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"say"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'hello Super'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"Sub"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"call"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"this"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Super"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("constructor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" sub "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Sub"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("   "),(0,t.Wm)("span",{class:"token comment"},"// 1"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("sub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// Super"),(0,t.Uk)("\nsub"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"say"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("             "),(0,t.Wm)("span",{class:"token comment"},"// hellp Super"),(0,t.Uk)("\n")])])],-1),C=(0,t.Wm)("p",null,"我们来看另外几段代码：",-1),j=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" cachedCtors "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" extendOptions"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_Ctor "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("extendOptions"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_Ctor "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("cachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" cachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\ncachedCtors"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("SuperId"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Sub\n")])])],-1),O=(0,t.Wm)("p",null,[(0,t.Uk)("这几段代码是用来缓存的，作用是：如果我们先在"),(0,t.Wm)("code",null,"A.vue"),(0,t.Uk)("文件中引入了"),(0,t.Wm)("code",null,"header.vue"),(0,t.Uk)("组件，它会执行一遍"),(0,t.Wm)("code",null,"extend"),(0,t.Uk)("，随后我们又在"),(0,t.Wm)("code",null,"B.vue"),(0,t.Uk)("文件中引入了"),(0,t.Wm)("code",null,"header.vue"),(0,t.Uk)("，由于已经有了"),(0,t.Wm)("code",null,"header.vue"),(0,t.Uk)("组件的缓存，因此不再执行后续的代码，直接返回。")],-1),V=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// A.vue"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" MHeader "),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'@/components/header.vue'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'AComponent'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  components"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    MHeader\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// B.vue"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" MHeader "),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'@/components/header.vue'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'BComponent'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  components"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    MHeader\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// header.vue只会extend一次。"),(0,t.Uk)("\n")])])],-1),H=(0,t.Wm)("p",null,[(0,t.Uk)("最后在继承完毕后，还处理了"),(0,t.Wm)("code",null,"props"),(0,t.Uk)("、"),(0,t.Wm)("code",null,"computed"),(0,t.Uk)("以及各种全局API方法，这部分的逻辑跟之前我们提到过的是一样的，不再此累述。")],-1),N=(0,t.Wm)("strong",null,"安装组件钩子函数",-1),_=(0,t.Uk)("：我们在前面提到过，"),A=(0,t.Wm)("code",null,"Vue",-1),M=(0,t.Uk)("中的虚拟"),I=(0,t.Wm)("code",null,"DOM",-1),E=(0,t.Uk)("借鉴了开源库"),P={href:"https://github.com/snabbdom/snabbdom",target:"_blank",rel:"noopener noreferrer"},D=(0,t.Uk)("snabbdom"),$=(0,t.Uk)("的实现，在这个库里面当"),T=(0,t.Wm)("code",null,"VNode",-1),F=(0,t.Uk)("节点处于不同的场景下，提供了对应的钩子函数来方便我们处理相关的逻辑，这些钩子函数如下："),B=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:o,alt:"VNode钩子函数"})],-1),G=(0,t.Wm)("p",null,[(0,t.Uk)("在"),(0,t.Wm)("code",null,"Vue"),(0,t.Uk)("中也用到了这些钩子函数，它的定义如下：")],-1),R=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" componentVNodeHooks "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"init"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("     "),(0,t.Wm)("span",{class:"token comment"},"// 初始化时触发"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"prepatch"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// patch之前触发"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"insert"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("   "),(0,t.Wm)("span",{class:"token comment"},"// 插入到DOM时触发"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"destroy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("   "),(0,t.Wm)("span",{class:"token comment"},"// 节点移除之前触发"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),Y=(0,t.Wm)("p",null,[(0,t.Uk)("我们来看一下，"),(0,t.Wm)("code",null,"installComponentHooks"),(0,t.Uk)("方法的定义：")],-1),z=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" hooksToMerge "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"keys"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("componentVNodeHooks"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"installComponentHooks"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("data"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" VNodeData")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" hooks "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" data"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hook "),(0,t.Wm)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hook "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)(" hooksToMerge"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i"),(0,t.Wm)("span",{class:"token operator"},"++"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" key "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" hooksToMerge"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("i"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" existing "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" hooks"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" toMerge "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" componentVNodeHooks"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("existing "),(0,t.Wm)("span",{class:"token operator"},"!=="),(0,t.Uk)(" toMerge "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"!"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("existing "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" existing"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_merged"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      hooks"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" existing "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"mergeHook"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("toMerge"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" existing"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" toMerge\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),L=(0,t.Wm)("p",null,[(0,t.Uk)("在"),(0,t.Wm)("code",null,"installComponentHooks"),(0,t.Uk)("方法执行的时候，遍历了我们定义的"),(0,t.Wm)("code",null,"hooks"),(0,t.Uk)("对象的属性，然后在遍历的过程中把这些"),(0,t.Wm)("code",null,"hook"),(0,t.Uk)("赋值到我们传递的参数上面，其中有一个地方值得我们注意：如果已经有了相同的"),(0,t.Wm)("code",null,"hook"),(0,t.Uk)("，则会执行"),(0,t.Wm)("code",null,"mergeHook"),(0,t.Uk)("来合并，"),(0,t.Wm)("code",null,"mergeHook"),(0,t.Uk)("方法的定义如下：")],-1),q=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"mergeHook"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("f1"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" any"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" f2"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" any")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" Function "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"merged"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("a"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" b")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// flow complains about extra args which is why we use any"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"f1"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("a"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" b"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"f2"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("a"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" b"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  merged"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("_merged "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" merged\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),J=(0,t.Wm)("p",null,"我们以下面代码为例，来举例说明：",-1),K=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 合并前"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" hooks "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"init"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'init hook 1'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  data"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    hook"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function-variable function"},"init"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'init hook 2'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 合并"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"mergeHook"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 合并后"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  data"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    hook"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function-variable function"},"init"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token function"},"init1"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token function"},"init2"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),Q=(0,t.Wm)("p",null,[(0,t.Uk)("在"),(0,t.Wm)("code",null,"createComponent"),(0,t.Uk)("这一小节，我们介绍了组件会进行"),(0,t.Wm)("code",null,"mergeOptions"),(0,t.Uk)("配置合并，为了更好的理解"),(0,t.Wm)("code",null,"path"),(0,t.Uk)("的过程，我们会在接下来的小节优先介绍"),(0,t.Wm)("code",null,"mergeOptions"),(0,t.Uk)("配置合并策略。")],-1),X={render:function(n,s){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.j4)(t.HY,null,[e,c,p,k,u,l,m,W,i,r,U,d,g,f,y,b,w,v,h,x,S,C,j,O,V,H,(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[N,_,A,M,I,E,(0,t.Wm)("a",P,[D,(0,t.Wm)(a)]),$,T,F])]),B,G,R,Y,z,L,q,J,K,Q],64)}}}}]);