(self.webpackChunkgordan404wiki=self.webpackChunkgordan404wiki||[]).push([[9476],{8203:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-dd83d4da",path:"/interview/webpack.html",title:"前端进阶指北",lang:"zh-CN",frontmatter:{sidebar:"auto"},excerpt:"",headers:[{level:2,title:"webpack相关",slug:"webpack相关",children:[{level:3,title:"CommonJs、AMD、CMD、ES Module、UMD",slug:"commonjs、amd、cmd、es-module、umd",children:[]},{level:3,title:"ES Module 和 Commonjs 区别",slug:"es-module-和-commonjs-区别",children:[]},{level:3,title:"前端为何要进行打包和构建",slug:"前端为何要进行打包和构建",children:[]},{level:3,title:"webpack的构建流程",slug:"webpack的构建流程",children:[]},{level:3,title:"loader 和 plugin 的区别",slug:"loader-和-plugin-的区别",children:[]},{level:3,title:"常用的loader 和 plugin",slug:"常用的loader-和-plugin",children:[]},{level:3,title:"你们一般webpack会配置些什么",slug:"你们一般webpack会配置些什么",children:[]},{level:3,title:"在webpack中如何做到长缓存优化(增量发布)？",slug:"在webpack中如何做到长缓存优化-增量发布",children:[]},{level:3,title:"webpack-merge",slug:"webpack-merge",children:[]},{level:3,title:"多入口配置entry",slug:"多入口配置entry",children:[]},{level:3,title:"CSS抽离",slug:"css抽离",children:[]},{level:3,title:"抽离公共代码(splitChunks)",slug:"抽离公共代码-splitchunks",children:[]},{level:3,title:"懒加载",slug:"懒加载",children:[]},{level:3,title:"处理JSX和VUE",slug:"处理jsx和vue",children:[]},{level:3,title:"module chunk bundle 的区别",slug:"module-chunk-bundle-的区别",children:[]},{level:3,title:"webpack 性能优化",slug:"webpack-性能优化",children:[]},{level:3,title:"配置Babel、babel-polyfill",slug:"配置babel、babel-polyfill",children:[]},{level:3,title:"如何产出一个lib",slug:"如何产出一个lib",children:[]},{level:3,title:"GitLab CI/CD 后的构建、发布",slug:"gitlab-ci-cd-后的构建、发布",children:[]}]}],filePathRelative:"interview/webpack.md",git:{updatedTime:1638290609e3,contributors:[{name:"lishuaixingNewBee",email:"vae.china@foxmail.com",commits:13}]}}},331:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Hn});var t=a(4057);const o=a.p+"assets/img/33.0dfcd6fc.png",e=a.p+"assets/img/34.18080c34.png",c=a.p+"assets/img/36.a0c52e52.png",p=a.p+"assets/img/35.bf18bb02.jpeg",l=(0,t.Wm)("h1",{id:"前端进阶指北",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#前端进阶指北","aria-hidden":"true"},"#"),(0,t.Uk)(" 前端进阶指北")],-1),k=(0,t.Wm)("h2",{id:"webpack相关",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack相关","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack相关")],-1),m=(0,t.Wm)("h3",{id:"commonjs、amd、cmd、es-module、umd",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#commonjs、amd、cmd、es-module、umd","aria-hidden":"true"},"#"),(0,t.Uk)(" CommonJs、AMD、CMD、ES Module、UMD")],-1),u=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,"中，同步意味着阻塞加载，浏览器资源是异步加载的。"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"AMD"),(0,t.Uk)("：依赖前置, 提前执行("),(0,t.Wm)("code",null,"requireJS"),(0,t.Uk)(")。优点：适合在浏览器环境异步加载；缺点：阅读和书写比较困难。")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"CMD"),(0,t.Uk)("：依赖就近、延迟执行("),(0,t.Wm)("code",null,"seaJS"),(0,t.Uk)(")。优点：很容易在node中运行, 支持动态引入；缺点：依赖spm打包，模块的加载逻辑偏重。")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"CommonJs"),(0,t.Uk)("：优点：node中自带模块，服务器端模块便于重用。缺点：同步的模块加载方式不适合在浏览器环境")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"ES Module"),(0,t.Uk)("：静态引入,编译时引入,编译时确定依赖关系,不可以动态加载语句。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。优点：容易进行静态分析；缺点：原生浏览器未实现该标准。")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"UMD"),(0,t.Uk)(": 主要用来解决CommonJS模式和AMD模式代码不能通用的问题，并同时还支持老式的全局变量规范。")])])],-1),W=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doc-comment comment"},"/** AMD写法 **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"define"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"c"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"d"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"e"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"f"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("a"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" b"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" c"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" d"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" e"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" f")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** CMD写法 **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"define"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("require"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" exports"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" module")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" a "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./a'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"//在需要时申明"),(0,t.Uk)("\n    a"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"doSomething"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" b "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./b'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        b"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"doSomething"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** CommonJS **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" num "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  num\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" num "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"./index.js"'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** ES Module **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" basicNum"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" add "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" basicNum"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" add "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./math'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n\n")])])],-1),i=(0,t.Wm)("h3",{id:"es-module-和-commonjs-区别",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#es-module-和-commonjs-区别","aria-hidden":"true"},"#"),(0,t.Uk)(" ES Module 和 Commonjs 区别")],-1),r=(0,t.Uk)("强烈建议阅读"),U={href:"https://segmentfault.com/a/1190000021458835",target:"_blank",rel:"noopener noreferrer"},d=(0,t.Uk)("es6Module与CommonJS"),g=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"CommonJs"),(0,t.Uk)(" 动态引入，执行时引入 可以动态加载语句，代码发生在运行时")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"CommonJs"),(0,t.Uk)(" 导出值是拷贝，可以修改导出的值，这在代码出错时，不好排查引起变量污染")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"ES Module"),(0,t.Uk)(" 静态引入,编译时引入,不可以动态加载语句，只能声明在该文件的最顶部，代码发生在编译时")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Es Module"),(0,t.Uk)(" 导出是引用值之前都存在映射关系，并且值都是可读的，不会被修改。")]),(0,t.Wm)("li",null,[(0,t.Uk)("只有"),(0,t.Wm)("code",null,"ES6 Module"),(0,t.Uk)(" 才能静态分析，实现 "),(0,t.Wm)("code",null,"Tree-Shaking")])])],-1),h=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doc-comment comment"},"/*** Commonjs ***/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// Commonjs Node.js是commonJS规范的主要实践者(module、exports、require、global)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// index.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" num "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    num"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"add"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n       "),(0,t.Wm)("span",{class:"token operator"},"++"),(0,t.Uk)(" num \n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 引用自定义的模块时，参数包含路径"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" num"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" add "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"./index.js"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("num"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 0"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"add"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("num"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 0 值没有改变"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/*** es6 Modules ***/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" counter "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"incCounter"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  counter "),(0,t.Wm)("span",{class:"token operator"},"++"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" counter"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" incCounter "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./exportDemo.mjs'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"incCounter"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("counter"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 打印结果为2，而不是初始值的1"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/**commonJS**/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" apiList "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'../api/index.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("isDev"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// commonJS 可以动态引入,执行时引入"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" apiList "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'.../api/index.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** es6 Modules**/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" apiList form "),(0,t.Wm)("span",{class:"token string"},"'../api/index.js'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("isDev"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 编译时报错，语法不支持，只能静态引入"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" apiList form2 "),(0,t.Wm)("span",{class:"token string"},"'../api2/index.js'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])])],-1),b=(0,t.Wm)("h3",{id:"前端为何要进行打包和构建",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#前端为何要进行打包和构建","aria-hidden":"true"},"#"),(0,t.Uk)(" 前端为何要进行打包和构建")],-1),f=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"代码方面")]),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"体积更小(Tree-Sahking、压缩、合并)，加载更快"),(0,t.Wm)("li",null,"编译高级语言或者语法(TS、ES6+、 模块化、scss)"),(0,t.Wm)("li",null,"兼容性和错误检查(polyfill、postcss、eslint)")]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"研发流程")]),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"统一、高效的开发环境(多人团队开发)"),(0,t.Wm)("li",null,"统一的构建流程和产出标准"),(0,t.Wm)("li",null,"集成公司构造规范(CI/CD、提测、上线等)")])],-1),w=(0,t.Wm)("h3",{id:"webpack的构建流程",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack的构建流程","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack的构建流程")],-1),x=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"初始化参数："),(0,t.Uk)(" 解析"),(0,t.Wm)("code",null,"webpack"),(0,t.Uk)("配置参数，合并"),(0,t.Wm)("code",null,"shell"),(0,t.Uk)("传入和"),(0,t.Wm)("code",null,"webpack.config.js"),(0,t.Uk)("文件配置的参数,形成最后的配置结果；")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"开始编译："),(0,t.Uk)(" 上一步得到的参数初始化"),(0,t.Wm)("code",null,"compiler"),(0,t.Uk)("对象，注册所有配置的插件，插件 监听webpack构建生命周期的事件节点，做出相应的反应，执行对象的"),(0,t.Wm)("code",null,"run"),(0,t.Uk)("方法开始执行编译；")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"确定入口："),(0,t.Uk)(" 从配置的"),(0,t.Wm)("code",null,"entry"),(0,t.Uk)("入口，开始解析文件构建"),(0,t.Wm)("code",null,"AST"),(0,t.Uk)("语法树，找出依赖，递归下去；")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"编译模块："),(0,t.Uk)(" 递归中根据文件类型和"),(0,t.Wm)("code",null,"loader"),(0,t.Uk)("配置，调用所有配置的loader对文件进行转换，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理；")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"完成模块编译并输出："),(0,t.Uk)(" 递归完事后，得到每个文件结果，包含每个模块以及他们之间的依赖关系，根据"),(0,t.Wm)("code",null,"entry"),(0,t.Uk)("或分包配置生成代码块"),(0,t.Wm)("code",null,"chunk"),(0,t.Uk)(";")])])],-1),y=(0,t.Wm)("h3",{id:"loader-和-plugin-的区别",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#loader-和-plugin-的区别","aria-hidden":"true"},"#"),(0,t.Uk)(" loader 和 plugin 的区别")],-1),v=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"作用:")])]),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"loader"),(0,t.Uk)(" webpack 本身只能打包commonjs规范的js文件，针对css，图片等格式的文件没法打包, loader相当于翻译官、模块转换器。(执行顺序从下至上，从又往左)")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"plugin"),(0,t.Uk)("完成的是loader不能完成的功能,通过钩子可以涉及到 webpack 的整一个事件流程,也就是说 plugin 可以通过监听这些生命周期的钩子在合适的时机使用 webpack 提供的API 做一些事情。")])]),(0,t.Wm)("p",null,"如：针对html文件打包和拷贝（还有很多设置）的插件：html-webpack-plugin。 不但完成了html文件的拷贝，打包，还给html中自动增加了引入打包后的js文件的代码（），还能指明把js文件引入到html文件的底部等等"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"从运行时机的角度区:")])]),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"loader运行在打包文件之前（loader为在模块加载时的预处理文件）"),(0,t.Wm)("li",null,"plugins在整个编译周期都起作用")])],-1),j=(0,t.Wm)("h3",{id:"常用的loader-和-plugin",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#常用的loader-和-plugin","aria-hidden":"true"},"#"),(0,t.Uk)(" 常用的loader 和 plugin")],-1),P=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// webpack相当于是一个 loader 和 plugin 的集合"),(0,t.Uk)("\nloader\n"),(0,t.Wm)("span",{class:"token number"},"1."),(0,t.Uk)(" 样式类的 loader：css"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" style"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" less"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" postcss"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token function"},"loader"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("添加"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webkit"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("等\n"),(0,t.Wm)("span",{class:"token number"},"2."),(0,t.Uk)(" 文件类的 loader：url"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader "),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("file"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" raw"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader等\n"),(0,t.Wm)("span",{class:"token number"},"3."),(0,t.Uk)(" 编译类的 loader：vue"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" ts"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader等\n"),(0,t.Wm)("span",{class:"token number"},"4."),(0,t.Uk)(" 校验测试类 loader：eslint"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" jslint"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader等\nplugin\nignore"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin：忽略部分文件\nhtml"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin：简化 "),(0,t.Wm)("span",{class:"token constant"},"HTML"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"文件创建"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("依赖于 html"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nclean"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" 目录清理\nmini"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("css"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("extract"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" 分离样式文件，"),(0,t.Wm)("span",{class:"token constant"},"CSS"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"提取为独立文件，支持按需加载"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("替代extract"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nvconsole"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" 移动端控制台\n")])])],-1),C=(0,t.Wm)("h3",{id:"你们一般webpack会配置些什么",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#你们一般webpack会配置些什么","aria-hidden":"true"},"#"),(0,t.Uk)(" 你们一般webpack会配置些什么")],-1),S=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token number"},"1."),(0,t.Uk)(" production "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Uk)(" 一些环境变量\n"),(0,t.Wm)("span",{class:"token number"},"2."),(0,t.Uk)(" babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("polyfill 转"),(0,t.Wm)("span",{class:"token constant"},"ES5"),(0,t.Uk)("兼容低版本浏览器\n"),(0,t.Wm)("span",{class:"token number"},"3."),(0,t.Uk)(" splitChunks 抽离公共代码和样式\n"),(0,t.Wm)("span",{class:"token number"},"4."),(0,t.Uk)(" dll把一些第三方法库预先编译\n"),(0,t.Wm)("span",{class:"token number"},"6."),(0,t.Uk)(" 开启eslint、fixEslint、git "),(0,t.Wm)("span",{class:"token function"},"commitizen"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("git cz"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token number"},"7."),(0,t.Uk)(" 移动端配置vconsole"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin 插件、 postcss Rem、公司内部库\n")])])],-1),_=(0,t.Wm)("h3",{id:"在webpack中如何做到长缓存优化-增量发布",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#在webpack中如何做到长缓存优化-增量发布","aria-hidden":"true"},"#"),(0,t.Uk)(" 在webpack中如何做到长缓存优化(增量发布)？")],-1),M=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"浏览器在用户访问页面的时候，为了加快加载速度会对用户访问的静态资源进行存储，但是每一次代码升级或更新都需要浏览器下载新的代码，最简单方便的方式就是引入新的文件名称"),(0,t.Wm)("li",null,"webpack中可以在output中指定chunkhash，并且分离经常更新的代码和框架代码。通过NameModulesPlugin或HashedModuleIdsPlugin使再次打包文件名不变")])],-1),D=(0,t.Wm)("h3",{id:"webpack-merge",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack-merge","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack-merge")],-1),E=(0,t.Wm)("div",{class:"language-text ext-text"},[(0,t.Wm)("pre",{class:"language-text"},[(0,t.Wm)("code",null,"用webpack-merge将配置文件拆分为3个文件，一个是webpack.common.js，即不管是生产环境还是开发环境都会用到的部分，以及webpack.prod.js和webpack.dev.js, 并且使用webpack-merge来合并对象。\n")])],-1),q=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.common.js")],-1),I=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" HtmlWebpackPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'html-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vConsolePlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'vconsole-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 移动端调试vConsole"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 文件验证规则"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'babel-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// babel-loader 可以额外配置.babelrc文件"),(0,t.Uk)("\n                include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 包含处理哪些文件夹下的文件"),(0,t.Uk)("\n                exclude"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"node_modules"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 不包含，过滤的文件 "),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     test: /\\.vue$/,"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     loader: ['vue-loader'],"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     include: srcPath"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// },"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     test: /\\.css$/,"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     // loader 的执行顺序是：从后往前（知识点）"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     loader: ['style-loader', 'css-loader']"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// },"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// loader 的执行顺序是：从后往前"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'style-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(" \n                "),(0,t.Wm)("span",{class:"token comment"},"// 加了 postcss"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 注意:common.js 不应该用style-loader，只有在dev中存在，prod中用MiniCssExtractPlugin，后面【CSS抽离】会提到"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.less$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 增加 'less-loader' ，注意顺序"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'style-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'less-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"vConsolePlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            filter"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            enable"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" process"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("env"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token constant"},"NODE_ENV"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"!=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),J=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.dev.js")],-1),T=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpack "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpackCommonConf "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./webpack.common.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" smart "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack-merge'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'development'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 直接引入图片 url"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'file-loader'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'development'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'development'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    devServer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        port"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"8080"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        progress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 显示打包的进度条"),(0,t.Uk)("\n        contentBase"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 根目录"),(0,t.Uk)("\n        open"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 自动打开浏览器"),(0,t.Uk)("\n        compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 启动 gzip 压缩"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 设置代理"),(0,t.Uk)("\n        proxy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 将本地 /api/xxx 代理到 localhost:3000/api/xxx"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token string"},"'/api'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'http://localhost:3000'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n            "),(0,t.Wm)("span",{class:"token comment"},"// 将本地 /api2/xxx 代理到 localhost:3000/xxx"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token string"},"'/api2'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                target"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'http://localhost:3000'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                pathRewrite"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'/api2'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"''"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),H=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.prod.js")],-1),L=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpack "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" CleanWebpackPlugin "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'clean-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpackCommonConf "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./webpack.common.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" smart "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack-merge'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'bundle.[contentHash:8].js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 打包代码时，加上 hash 戳,内容改变hash才会变(hash增量更新)"),(0,t.Uk)("\n        path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 图片 - 考虑 base64 编码的情况"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'url-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    options"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 小于 5kb 的图片用 base64 格式产出"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 否则，依然延用 file-loader 的形式，产出 url 格式"),(0,t.Uk)("\n                        limit"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"5"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"*"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1024"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 打包到 img 目录下"),(0,t.Uk)("\n                        outputPath"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'/img1/'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),N=(0,t.Wm)("h4",{id:"postcss-loader",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#postcss-loader","aria-hidden":"true"},"#"),(0,t.Uk)(" postcss-loader")],-1),A=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 依赖autoprefixer"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 需要添加 postcss.config.js文件"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" autoprefixer "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'autoprefixer'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" pxtorem "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'postcss-pxtorem'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"exports"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" file "),(0,t.Wm)("span",{class:"token punctuation"},"}")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" remUnit\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" file"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("dirname "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" file"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("dirname"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"indexOf"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'vant'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    remUnit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"37.5"),(0,t.Uk)(" \n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    remUnit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"75"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// rem 换算"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"autoprefixer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 自动加前缀"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"pxtorem"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rootValue"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" remUnit"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        propList"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'*'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        selectorBlackList"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'van-circle__layer'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])])],-1),R=(0,t.Wm)("h3",{id:"多入口配置entry",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#多入口配置entry","aria-hidden":"true"},"#"),(0,t.Uk)(" 多入口配置entry")],-1),B=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"一个项目中保存了多个 HTML 模版，不同的模版有不同的入口，并且有各自的 router、store 等；"),(0,t.Wm)("li",null,"不仅可以打包出不同 HTML，而且开发的时候也可以顺利进行调试；"),(0,t.Wm)("li",null,"不同入口的文件可以引用同一份组件、图片等资源，也可以引用不同的资源；")])],-1),V=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// webpack.common.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" HtmlWebpackPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'html-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 多页面，在entry入口出需要建多个"),(0,t.Uk)("\n        index"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        other"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// new HtmlWebpackPlugin({"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     template: path.join(srcPath, 'index.html'),"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     filename: 'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 index.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 只引用 index.js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 other.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'other'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 只引用 other.js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.prod.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// filename: 'bundle.[contentHash:8].js',  // 打包代码时，加上 hash 戳"),(0,t.Uk)("\n        filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].[contentHash:8].js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// name 即多入口时 entry 的 key"),(0,t.Uk)("\n        path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),z=(0,t.Wm)("h3",{id:"css抽离",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#css抽离","aria-hidden":"true"},"#"),(0,t.Uk)(" CSS抽离")],-1),O=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,[(0,t.Uk)("原本打包过后是css-in-js,在开发环境中使用HMR,style-loader会在页面中创建很多"),(0,t.Wm)("code",null,"<style>"),(0,t.Uk)("标签,增加js体积,配置完"),(0,t.Wm)("code",null,"MiniCssExtractPlugin后"),(0,t.Uk)(",可以将css单独打包出来"),(0,t.Wm)("code",null,"MiniCssExtractPlugin"),(0,t.Uk)("这个插件应该只在生产环境构建中使用，并且在loader链中不应该有style-loader,抽离之后可以相互引用。")])],-1),$=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" MiniCssExtractPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'mini-css-extract-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 图片 - 考虑 base64 编码的情况"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'url-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    options"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 小于 5kb 的图片用 base64 格式产出"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 否则，依然延用 file-loader 的形式，产出 url 格式"),(0,t.Uk)("\n                        limit"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"5"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"*"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1024"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 打包到 img 目录下"),(0,t.Uk)("\n                        outputPath"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'/img1/'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 css"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n                    MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 注意，这里不再用 style-loader"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 less --\x3e css"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.less$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n                    MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 注意，这里不再用 style-loader"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'less-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n      "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 css 文件"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css/main.[contentHash:8].css'"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    optimization"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 压缩 css、js"),(0,t.Uk)("\n      minimizer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TerserJSPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"OptimizeCSSAssetsPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])])],-1),G=(0,t.Wm)("h3",{id:"抽离公共代码-splitchunks",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#抽离公共代码-splitchunks","aria-hidden":"true"},"#"),(0,t.Uk)(" 抽离公共代码(splitChunks)")],-1),K=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"某块业务代码被多个入口引用，抽离出来，放到一个公共模块中。这样不管这个模块被多少个入口引用，都只会在最终打包结果中出现一次解决代码冗余。"),(0,t.Wm)("li",null,"第三方库一般很大，而且代码基本不会再改动,我会把一些特别大的库分别独立打包，(抽离后不会因为业务代码改变，而导致库hash值也变)，剩下的加起来如果还很大，就把它按照一定大小切割成若干模块。")])],-1),X=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// prod.common.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    optimization"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 压缩 css"),(0,t.Uk)("\n        minimizer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TerserJSPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"OptimizeCSSAssetsPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 分割代码块"),(0,t.Uk)("\n        splitChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'all'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token doc-comment comment"},"/**\n             * initial 入口 chunk，对于异步导入的文件不处理\n                async 异步 chunk，只对异步导入的文件处理\n                all 全部 chunk\n             */"),(0,t.Uk)("\n\n            "),(0,t.Wm)("span",{class:"token comment"},"// 缓存分组"),(0,t.Uk)("\n            cacheGroups"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 第三方模块"),(0,t.Uk)("\n                vendor"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'vendor'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// chunk 名称"),(0,t.Uk)("\n                    priority"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 权限更高，优先抽离，重要！！！"),(0,t.Uk)("\n                    test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"node_modules"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 命中第三方模块"),(0,t.Uk)("\n                    minSize"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 大小限制"),(0,t.Uk)("\n                    minChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 最少复用过几次"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                "),(0,t.Wm)("span",{class:"token comment"},"// 公共的模块"),(0,t.Uk)("\n                common"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// chunk 名称"),(0,t.Uk)("\n                    priority"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 优先级"),(0,t.Uk)("\n                    minSize"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 公共模块的大小限制(如果太小就没必要单独打包了)"),(0,t.Uk)("\n                    minChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 公共模块最少复用过几次"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.common.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// new HtmlWebpackPlugin({"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     template: path.join(srcPath, 'index.html'),"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     filename: 'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 index.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'vendor'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 要考虑代码分割"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 other.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'other'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 考虑代码分割"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// chunks在哪些地方用到"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 1.entry(中可以表示chunks的引用)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 2.splitChunks(也可以定义chunks)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 3.HtmlWebpackPlugin(使用chunks)"),(0,t.Uk)("\n")])])],-1),Y=(0,t.Wm)("h3",{id:"懒加载",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#懒加载","aria-hidden":"true"},"#"),(0,t.Uk)(" 懒加载")],-1),F=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// export default {"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//   message: 'this is data'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 引入动态数据 - 懒加载"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"setTimeout"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 回顾vue、react异步组件都是用的这个语法，是js的语法"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 异步加载也是定义一个chunk"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./data.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"then"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"res"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("default"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("message"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 主力这里的defalut"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"List"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token comment"},'/* webpackChunkName: "home" */'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./List.vue'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])])],-1),Q=(0,t.Wm)("h3",{id:"处理jsx和vue",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理jsx和vue","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理JSX和VUE")],-1),Z=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// React"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm install --save-dev @babel/preset-react"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// .babelrc文件中配置"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"presets"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"@babel/preset-react"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"plugins"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// Vue直接只用vue-loader"),(0,t.Uk)("\n")])])],-1),nn=(0,t.Wm)("h3",{id:"module-chunk-bundle-的区别",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#module-chunk-bundle-的区别","aria-hidden":"true"},"#"),(0,t.Uk)(" module chunk bundle 的区别")],-1),sn=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:o,alt:"module chunk bundle"})],-1),an=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"module: 各个源码文件，webpack中的一切皆模块(js、img、css、sass...)"),(0,t.Wm)("li",null,"chunk: 多个模块合并成的,如 entry 、import()、 splitChunk"),(0,t.Wm)("li",null,"bundle: webpack 处理好 chunk 文件后，最后会输出 bundle 文件，这个 bundle 文件包含了经过加载和编译的最终源文件，所以它可以直接在浏览器中运行。")]),(0,t.Wm)("p",null,"module、chunk 和 bundle 其实就是同一份逻辑代码在不同转换场景下的取了三个名字： 我们直接写出来的是 module，webpack 处理时是 chunk，最后生成浏览器可以直接运行的 bundle。")],-1),tn=(0,t.Wm)("h3",{id:"webpack-性能优化",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack-性能优化","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack 性能优化")],-1),on=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"优化打包构建速度 - 开发体验和效率"),(0,t.Wm)("li",null,"优化产出代码 - 产品性能")])],-1),en=(0,t.Wm)("h4",{id:"优化打包构建速度",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#优化打包构建速度","aria-hidden":"true"},"#"),(0,t.Uk)(" 优化打包构建速度")],-1),cn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Loader"),(0,t.Uk)("优化配置 【dev】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"IgnorePlugin"),(0,t.Uk)(" (忽略第三方包指定目录，让这些指定目录(如moment的语言包)不要被打包进去)【prod】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"noParse"),(0,t.Uk)(" 不去解析属性值代表的库的依赖(jquery) 【prod】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"happyPack"),(0,t.Uk)(" 开启多个进程去打包(按需开启)，提高构建速度（特别是多核CPU） "),(0,t.Wm)("code",null,"ParallelUglifyPlugin"),(0,t.Uk)(" webpack内置Uglify工具压缩JS,但是是单线程，"),(0,t.Wm)("code",null,"ParallelUglifyPlugin"),(0,t.Uk)(" 是多进程压更快，和"),(0,t.Wm)("code",null,"happyPack"),(0,t.Uk)("同理 【prod】")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"项目较大，打包较慢，开启多进程能提高速度"),(0,t.Wm)("li",null,"项目较小，打包很快，开启多进程会降低速度（进程多了，进程开启、销毁、通信），欲速则不达")]),(0,t.Wm)("ol",{start:"5"},[(0,t.Wm)("li",null,"热更新 模块热替换，解决页面刷新导致的状态丢失问题。【dev】"),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"DllPlugin"),(0,t.Uk)(" 我们的代码都可以至少简单区分成业务代码和第三方库。大部分第三方库框架如Vue React体积大，比较稳定、不常升级,构建慢。使用DllPlugin 动态库就不需要重新打包，每次构建只重新打包业务代码。【dev】")])])],-1),pn=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,[(0,t.Uk)("1. 优化"),(0,t.Wm)("code",null,"Loader"),(0,t.Uk)("配置")])],-1),ln=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// Loader处理文件的转换操作是很耗时的，所以需要让尽可能少的文件被Loader处理"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},"'babel-loader?cacheDirectory'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//开启转换结果缓存(加上cacheDirectory参数后，启用缓存之后，如ES6没有改的就不会重新编译)"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'src'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//只对src目录中文件采用babel-loader"),(0,t.Uk)("\n    exclude"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token string"},"' ./node_modules'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//排除node_modules目录下的文件"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// include或者exclude确定范围，提升速度"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),kn=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"2. IgnorePlugin")],-1),mn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 忽略第三方包指定目录，让这些指定目录不要被打包进去"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 当我们使用moment,是一个时间工具包，内部里面把所有的语言包都引入；"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 我们可以控制解析改包时，可以忽略调引入的文件。"),(0,t.Uk)("\nplugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"//weback自带的插件 忽略"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("IgnorePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.\\/locale"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"moment"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//优化3   如果引入这个moment包时 会忽略调 locale文件"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token string"},'"./public/index.html"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//我们要手动引入需要的语言包"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//手动引入中文包"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'// import "moment/locale/zh-cn";'),(0,t.Uk)("\n")])])],-1),un=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"3. noParse")],-1),Wn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 不去解析属性值代表的库的依赖,webpack精准过滤不需要解析的文件."),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 当解析jq的时候,会去解析jq这个库是否有依赖其他的包,我们对类似jq这类依赖库，"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 一般会认为不会引用其他的包(特殊除外,自行判断)。所以，对于这类不引用其他的"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 包的库，我们在打包的时候就没有必要去解析，这样能够增加打包速率。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 可以在webpack的module配置中增加noParse属性（以下代码只需要看module的noParse属性）"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        noParse"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"jquery|lodash"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"//接收参数  正则表达式 或函数"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token function-variable function"},"noParse"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"contentPath"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"jquery|lodash"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"test"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("contentPath"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),rn=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"4. happyPack 和 ParallelUglifyPlugin")],-1),Un=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// JS 单线程 =>nodeJS单线程=> webpack也是单线程，但是可以开启多个进程去打包，提高构建速度(特别是多核CPU)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack内置Uglify工具压缩JS,但是是单线程，使用ParallelUglifyPlugin` 是多进程压更快，和`happyPack`同理"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm i -D happypack"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 把对 .js 文件的处理转交给 id 为 babel 的 HappyPack 实例"),(0,t.Uk)("\n            use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'happypack/loader?id=babel'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// exclude: /node_modules/"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nplugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// happyPack 开启多进程打包"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HappyPack"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 用唯一的标识符 id 来代表当前的 HappyPack 是用来处理一类特定的文件"),(0,t.Uk)("\n        id"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'babel'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 如何处理 .js 文件，用法和 Loader 配置中一样"),(0,t.Uk)("\n        loaders"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'babel-loader?cacheDirectory'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"ParallelUglifyPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 传递给 UglifyJS 的参数"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// （还是使用 UglifyJS 压缩，只不过帮助开启了多进程）"),(0,t.Uk)("\n        uglifyJS"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                beautify"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 最紧凑的输出"),(0,t.Uk)("\n                comments"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 删除所有的注释"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 删除所有的 `console` 语句，可以兼容ie浏览器"),(0,t.Uk)("\n                drop_console"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 内嵌定义了但是只用到一次的变量"),(0,t.Uk)("\n                collapse_vars"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 提取出出现多次但是没有定义成变量去引用的静态值"),(0,t.Uk)("\n                reduce_vars"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n")])])],-1),dn=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"5. 热更新"),(0,t.Wm)("img",{src:e,alt:"热更新"})],-1),gn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,"发展历史 保存后自动编译（Auto Compile） => 自动刷新浏览器（Live Reload） => HMR（Hot Module Replacement，模块热替换）"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"手动："),(0,t.Uk)(" 最早一切依赖手动，修改代码后需要手动执行"),(0,t.Wm)("code",null,"npm run build:xxx"),(0,t.Uk)(", 然后刷新页面。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Watch："),(0,t.Uk)(" 早期使用"),(0,t.Wm)("code",null,"gulp"),(0,t.Uk)("或者"),(0,t.Wm)("code",null,"webpack"),(0,t.Uk)("配置"),(0,t.Wm)("code",null,"Watch"),(0,t.Uk)("模式，通过监控源码文件的变化来解决上面不能自动编译。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Live Reload："),(0,t.Uk)(" 每次代码变更后浏览器中的预览页面能自动显示最新效果而无须手动点击刷新，我们需要一种通信机制来连接浏览器中的预览页面与本地监控代码变更的进程 "),(0,t.Wm)("strong",null,"缺点："),(0,t.Uk)(" 整个网页刷新，速度较慢,状态会丢失(如：表单输入、弹框打开消失、颜色样式)")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Hot Module Replacement"),(0,t.Uk)(" 模块热替换，解决页面刷新导致的状态丢失问题。")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"CSS:"),(0,t.Uk)(" 使用 style-loader 和 css-loader 来解析导入的 CSS 文件。其中 css-loader 处理的是将导入的 CSS 文件转化为模块供后续 Loader 处理；而 style-loader 则是负责将 CSS 模块的内容在运行时添加到页面的 style 标签中。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"JS:"),(0,t.Uk)(" 使用hot.accept方法,当文本发生变更时，可以观察到浏览器端显示最新内容的同时并未触发页面刷新。vue-loader、 react-hot-loader 等加载器也都实现了该功能。")])])],-1),hn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// webpack中的配置"),(0,t.Uk)("\ndevServer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    port"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"8080"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    progress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 显示打包的进度条"),(0,t.Uk)("\n    contentBase"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 根目录"),(0,t.Uk)("\n    open"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 自动打开浏览器"),(0,t.Uk)("\n    compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 启动 gzip 压缩"),(0,t.Uk)("\n    hot"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 设置代理"),(0,t.Uk)("\n    proxy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// JS 代码中的热替换"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// ./text.js "),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Hello World'"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token comment"},"// ./index2.js "),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./text.js'"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" div "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" document"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createElement"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'div'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \ndocument"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"appendChild"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n  div"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("innerHTML "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hot"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 如果开启热更新"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 监听 xxx.js范围之内才热更新"),(0,t.Uk)("\n  module"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hot"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"accept"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./text.js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n    "),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])])],-1),bn=(0,t.Wm)("ol",{start:"6"},[(0,t.Wm)("li",null,"DllPlugin动态链接库插件")],-1),fn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,"我们的代码都可以至少简单区分成业务代码和第三方库。大部分第三方库框架如Vue React体积大，比较稳定、不常升级,构建慢。使用DllPlugin 动态库就不需要重新打包，每次构建只重新打包业务代码。 用webpack已内置DllPlugin, 打包出dll文件，DllReferencePlugin 使用dll文件")],-1),wn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// package.json"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'//   "scripts": {'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'//     "dll": "webpack --config webpack.dll.config"'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//  }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm run dll"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.dll.config.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 把React 相关的模块放到一个单独的攻台链接库"),(0,t.Uk)("\n    react"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react-dom'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react-redux'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 输出的动态链接库的文件名称，[name] 代表当前动态链接库的名称"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 也就是entry中配置的 react 和 polyfill"),(0,t.Uk)("\n    filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].dll.js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"//  输出的文件都放在dist 目录下"),(0,t.Uk)("\n    path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'dist/dll'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// library必须和后面dllplugin中的name一致 后面会说明"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 只所有加_dll_是为了防止全局变量冲突"),(0,t.Uk)("\n    library"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name]_dll_[hash]'"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 接入 DllPlugin"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"DllPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 动态链接库的全局变量名称，需要和 output.library 中保持一致"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 该字段的值也就是输出的 manifest.json 文件 中 name 字段的值"),(0,t.Uk)("\n      name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name]_dll_[hash]'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 描述动态链接库的 manifest.json 文件输出时的文件名称"),(0,t.Uk)("\n      path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'dist/dll'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].manifest.json'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 在入口文件引入dll文件"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("script src"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token string"},'"../../dist/dll/react.dll.js"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("script"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n")])])],-1),xn=(0,t.Wm)("h4",{id:"优化产出代码",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#优化产出代码","aria-hidden":"true"},"#"),(0,t.Uk)(" 优化产出代码")],-1),yn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Uk)("小图片"),(0,t.Wm)("code",null,"base64"),(0,t.Uk)("编码，减少网络请求")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"bundle"),(0,t.Uk)("加"),(0,t.Wm)("code",null,"hash"),(0,t.Uk)(",文件没有修改 hash不变，能被浏览器缓存命中")]),(0,t.Wm)("li",null,[(0,t.Uk)("懒加载，通过"),(0,t.Wm)("code",null,"import")]),(0,t.Wm)("li",null,"splitChunks 提取公共代码，重复引用，解决代码冗余。"),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"IgnorePlugin"),(0,t.Uk)(" (忽略第三方包指定目录，让这些指定目录(如moment的语言包)不要被打包进去)【prod】")]),(0,t.Wm)("li",null,[(0,t.Uk)("使用CDN加速 "),(0,t.Wm)("code",null,"publicPath"),(0,t.Uk)(" 配置CDN路径")]),(0,t.Wm)("li",null,[(0,t.Uk)("使用"),(0,t.Wm)("code",null,"production"),(0,t.Uk)(" 配置环境变量(接口域名、sourceMap、代码压缩)")]),(0,t.Wm)("li",null,[(0,t.Uk)("启动"),(0,t.Wm)("code",null,"Tree-Shaking"),(0,t.Uk)("(主要功能就是去除没有用到代码,必须用 ES6 Module 才能Tree-Shaking 生效, commonjs就不行, webpack中已经默认开启Tree-Shaking)")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Scope Hosting"),(0,t.Uk)(),(0,t.Wm)("code",null,"webpack3.0+"),(0,t.Uk)(" 的默认行为，当打包前会自动简化代码，减少变量(两个函数作用域合成一个，减少了代码量)")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"体积更小"),(0,t.Wm)("li",null,"合理分包，不重复加载"),(0,t.Wm)("li",null,"速度更快，内存使用更少")])],-1),vn=(0,t.Wm)("h4",{id:"scope-hosting",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#scope-hosting","aria-hidden":"true"},"#"),(0,t.Uk)(" Scope Hosting")],-1),jn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// hello.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'李狗蛋'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// main.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" str "),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./hello.js'"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 默认打包结果"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("module"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("__webpack_exports__"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" __webpack_require__")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" WEBPACK_IMPORTED_MODULEC_0__till_js__ "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"__webpackrequire__"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__WEBPACK_IMPORT_MODULE_0__util_js__"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("module"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("__webpack_exports__"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" __webpack_require__")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    __webpack_exports__"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"李狗蛋"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// Scope Hosting"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("module"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("__webpack_exports__"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" __webpack_require__")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" hello "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'李狗蛋'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("hello"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 1. 在A文件导出一个字符串，在B文件中引入之后，通过console.log打印出来。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 2. 通过webpack打包构建之后，会发现将这两个文件构建成了两个函数，一个函数内是我们输出的字符串，一个函数内是console.log语句。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 问题：两个函数也就是两个作用域；不仅代码增加了，可读性还不太友好。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 3. 使用scope hosting进行配置处理之后，会讲本身的两个函数作用域合成一个，减少了代码量，也便于阅读"),(0,t.Uk)("\n")])])],-1),Pn=(0,t.Wm)("h3",{id:"配置babel、babel-polyfill",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#配置babel、babel-polyfill","aria-hidden":"true"},"#"),(0,t.Uk)(" 配置Babel、babel-polyfill")],-1),Cn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Babel"),(0,t.Uk)(" 默认只转换新的 JavaScript 句法（syntax），而不转换新的 API")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"babel-polyfill"),(0,t.Uk)(" 是 "),(0,t.Wm)("code",null,"core-js"),(0,t.Uk)("(实现了promise、Symbol、Class\b等) 和 "),(0,t.Wm)("code",null,"regenerator-runtime"),(0,t.Uk)(" （ es6 generator 函数(处理异步)）两者的集合。")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Babel 7.4"),(0,t.Uk)("之后弃用了"),(0,t.Wm)("code",null,"babel-polyfill"),(0,t.Uk)(",推荐直接引入"),(0,t.Wm)("code",null,"core-js"),(0,t.Uk)(" 和 "),(0,t.Wm)("code",null,"regenerator-runtime")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"babel-runtime"),(0,t.Uk)(" 使用 "),(0,t.Wm)("code",null,"babel-polyfill"),(0,t.Uk)(" 会导致污染了全局环境，并且不同的代码文件中包含重复的代码，使用"),(0,t.Wm)("code",null,"babel-runtime"),(0,t.Uk)("就可以避免。")])]),(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"建议："),(0,t.Uk)(),(0,t.Wm)("code",null,"babel-runtime"),(0,t.Uk)(" 适合在组件，类库项目中使用，而"),(0,t.Wm)("code",null,"babel-polyfill"),(0,t.Uk)("适合在独立业务项目中使用。")])],-1),Sn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// ES6转ES5 分 语法 和API 两部分"),(0,t.Uk)("\nnpm i "),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token constant"},"D"),(0,t.Uk)(" webpack webpack"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("cli\nnpm i "),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token constant"},"D"),(0,t.Uk)(" babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("loader @babel"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("core\nnpm i "),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token constant"},"D"),(0,t.Uk)(" babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("preset"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("env\nnpm install "),(0,t.Wm)("span",{class:"token operator"},"--"),(0,t.Uk)("save babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("runtime\nnpm install "),(0,t.Wm)("span",{class:"token operator"},"--"),(0,t.Uk)("save"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("dev babel"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("plugin"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("transform"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)("runtime\n\n"),(0,t.Wm)("span",{class:"token comment"},"// npm babel src/xxx.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** .babelrc **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token string"},'"presets"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token string"},'"@babel/preset-env"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// preset-env 是es6、es7的plugins集合,常用语法解析,免去挨个配置"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"useBuiltIns"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"usage"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 自动添加 babel-polyfill的引用，按需引入"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"corejs"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// corejs版本"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},'// "babel/preset-typescript"'),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token string"},'"plugins"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token string"},'"@babel/plugin-transform-runtime"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"absoluteRuntime"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"corejs"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"helpers"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"regenerator"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},'"useESModules"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},'// 特别注意: 使用 import \'@babel/polyfill\', 会导致把整个polyfill都引入,体积大, 只配置"useBuiltIns": "usage",不用写import,就可以做到按需引入'),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** Babel 7.4 之前 **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// import '@babel/polyfill'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},"/** Babel 7.4 之后 **/"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// import 'core-js';"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// import 'regenerator-runtime/runtime';"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// babel-polyfill"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 1. 会导致污染了全局环境"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 2. 不同的代码文件中包含重复的代码，导致编译后的代码体积变大"),(0,t.Uk)("\nwindow"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"Promise"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"Array"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"includes"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// babel-runtime"),(0,t.Uk)("\n_promise"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"default"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n_includes"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"default"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n\n"),(0,t.Wm)("span",{class:"token comment"},"// core-js 实现了promise、Symbol、Class\b等,Babel 默认只转换新的 JavaScript 句法（syntax），而不转换新的 API,所以需要用到core-js,但core-js不支持generator"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// ES6 generator 函数(处理异步)， 后被async/await 替代"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token operator"},"*"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"tell"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"x"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'执行a处理'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"yield"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'a'"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'执行b处理'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"yield"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'b'"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'执行c处理'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"yield"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'c'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" k "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"tell"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("k"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 执行a处理  {value: 'a', done: false}"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("k"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 执行b处理  {value: 'b', done: false}"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("k"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 执行c处理  {value: 'c', done: false}"),(0,t.Uk)("\nconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("k"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"//  {value: undefined, done: true}"),(0,t.Uk)("\n")])])],-1),_n=(0,t.Wm)("h3",{id:"如何产出一个lib",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#如何产出一个lib","aria-hidden":"true"},"#"),(0,t.Uk)(" 如何产出一个lib")],-1),Mn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'gordanUtil.js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// lib 的文件名"),(0,t.Uk)("\n  path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 输出 到 dist目录下"),(0,t.Uk)("\n  library"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'gordanUtil'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// lib的全局变量名称"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),Dn=(0,t.Wm)("h3",{id:"gitlab-ci-cd-后的构建、发布",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#gitlab-ci-cd-后的构建、发布","aria-hidden":"true"},"#"),(0,t.Uk)(" GitLab CI/CD 后的构建、发布")],-1),En=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:c,alt:"CI/CD"})],-1),qn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"发布时间由平均 5 分钟减少到 1.5 分钟。从全程 5 分钟的手动操作，到只需合并分支代码、自动化构建及发布的 1.5 分钟。"),(0,t.Wm)("li",null,"前端构建放到 CI/CD 中，解决了本地构建可能导致线上代码打包后不一致的问题。")]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"提交代码到 GitLab 后，满足指定条件后会触发 pipeline 进行自动化构建、发布,pipeline 主要包括了，依赖下载，build 代码，发布到服务器这三个过程。")])],-1),In=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:p,alt:"CI/CD"})],-1),Jn=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"hooks是在特定事件发生之前或之后执行特定脚本代码功能（从概念上类比，就与监听事件、触发器之类的东西类似）。"),(0,t.Wm)("li",null,"Git hooks就是那些在Git执行特定事件（如commit、push、receive等）后触发运行的脚本。"),(0,t.Wm)("li",null,"gitlab的web hooks跟git hook类型。也是当项目发生提交代码、提交tag等动作会自动去调用url，这个url可以是更新代码，或者其他操作。")])],-1),Tn=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"//  Git hooks => Jenkins => 打包构建 => 回调"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// `Jenkins` 或者 `jean` 安装 `Git hook`插件"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 目标主机上安装 GitLab Runner，这里的目标主机指你要部署的服务器"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 在你安装gitlab-runner的服务器中安装docker。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 配置项目 指定 Branch 分支"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 小程序可能需要miniprogram-ci支持，其从微信开发者工具中抽离的关于小程序/小游戏项目代码的编译模块"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// .gitlab-ci.yml 配置文件：(.gitlab-ci.yml中至少有一个Job)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 回调可以通知 钉钉、微信机器人"),(0,t.Uk)("\n")])])],-1),Hn={render:function(n,s){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.j4)(t.HY,null,[l,k,m,u,W,i,(0,t.Wm)("p",null,[r,(0,t.Wm)("a",U,[d,(0,t.Wm)(a)])]),g,h,b,f,w,x,y,v,j,P,C,S,_,M,D,E,q,I,J,T,H,L,N,A,R,B,V,z,O,$,G,K,X,Y,F,Q,Z,nn,sn,an,tn,on,en,cn,pn,ln,kn,mn,un,Wn,rn,Un,dn,gn,hn,bn,fn,wn,xn,yn,vn,jn,Pn,Cn,Sn,_n,Mn,Dn,En,qn,In,Jn,Tn],64)}}}}]);