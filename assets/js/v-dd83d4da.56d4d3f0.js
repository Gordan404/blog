(self.webpackChunkgordan404wiki=self.webpackChunkgordan404wiki||[]).push([[9476],{8203:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-dd83d4da",path:"/interview/webpack.html",title:"前端面试指北",lang:"zh-CN",frontmatter:{sidebar:"auto"},excerpt:"",headers:[{level:2,title:"webpack相关面试题",slug:"webpack相关面试题",children:[{level:3,title:"webpack-merge",slug:"webpack-merge",children:[]},{level:3,title:"多入口配置entry",slug:"多入口配置entry",children:[]},{level:3,title:"CSS抽离",slug:"css抽离",children:[]},{level:3,title:"抽离公共代码(splitChunks)",slug:"抽离公共代码-splitchunks",children:[]},{level:3,title:"懒加载",slug:"懒加载",children:[]},{level:3,title:"处理JSX和VUE",slug:"处理jsx和vue",children:[]},{level:3,title:"module chunk bundle 的区别",slug:"module-chunk-bundle-的区别",children:[]},{level:3,title:"webpack 性能优化",slug:"webpack-性能优化",children:[]},{level:3,title:"ES6 Module 和 Commonjs 区别",slug:"es6-module-和-commonjs-区别",children:[]}]}],filePathRelative:"interview/webpack.md",git:{updatedTime:1634652588e3,contributors:[{name:"lishuaixingNewBee",email:"vae.china@foxmail.com",commits:6}]}}},4823:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>sn});var t=a(4057);const o=a.p+"assets/img/33.0dfcd6fc.png",e=a.p+"assets/img/34.18080c34.png",c=(0,t.Wm)("h1",{id:"前端面试指北",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#前端面试指北","aria-hidden":"true"},"#"),(0,t.Uk)(" 前端面试指北")],-1),p=(0,t.Wm)("h2",{id:"webpack相关面试题",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack相关面试题","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack相关面试题")],-1),k=(0,t.Wm)("h3",{id:"webpack-merge",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack-merge","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack-merge")],-1),l=(0,t.Wm)("div",{class:"language-text ext-text"},[(0,t.Wm)("pre",{class:"language-text"},[(0,t.Wm)("code",null,"用webpack-merge将配置文件拆分为3个文件，一个是webpack.common.js，即不管是生产环境还是开发环境都会用到的部分，以及webpack.prod.js和webpack.dev.js, 并且使用webpack-merge来合并对象。\n")])],-1),m=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.common.js")],-1),u=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" HtmlWebpackPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'html-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vConsolePlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'vconsole-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 移动端调试vConsole"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 文件验证规则"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'babel-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// babel-loader 可以额外配置.babelrc文件"),(0,t.Uk)("\n                include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 包含处理哪些文件夹下的文件"),(0,t.Uk)("\n                exclude"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"node_modules"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 不包含，过滤的文件 "),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     test: /\\.vue$/,"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     loader: ['vue-loader'],"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     include: srcPath"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// },"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     test: /\\.css$/,"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     // loader 的执行顺序是：从后往前（知识点）"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"//     loader: ['style-loader', 'css-loader']"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// },"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// loader 的执行顺序是：从后往前"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'style-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(" \n                "),(0,t.Wm)("span",{class:"token comment"},"// 加了 postcss"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 注意:common.js 不应该用style-loader，只有在dev中存在，prod中用MiniCssExtractPlugin，后面【CSS抽离】会提到"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.less$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 增加 'less-loader' ，注意顺序"),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'style-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'less-loader'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"vConsolePlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            filter"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            enable"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" process"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("env"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token constant"},"NODE_ENV"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"!=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),W=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.dev.js")],-1),i=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpack "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpackCommonConf "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./webpack.common.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" smart "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack-merge'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'development'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 直接引入图片 url"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'file-loader'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'development'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'development'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    devServer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        port"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"8080"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        progress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 显示打包的进度条"),(0,t.Uk)("\n        contentBase"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 根目录"),(0,t.Uk)("\n        open"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 自动打开浏览器"),(0,t.Uk)("\n        compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 启动 gzip 压缩"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 设置代理"),(0,t.Uk)("\n        proxy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 将本地 /api/xxx 代理到 localhost:3000/api/xxx"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token string"},"'/api'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'http://localhost:3000'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n            "),(0,t.Wm)("span",{class:"token comment"},"// 将本地 /api2/xxx 代理到 localhost:3000/xxx"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token string"},"'/api2'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                target"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'http://localhost:3000'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                pathRewrite"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'/api2'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"''"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),r=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"webpack.prod.js")],-1),U=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpack "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" CleanWebpackPlugin "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'clean-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" webpackCommonConf "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./webpack.common.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" smart "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'webpack-merge'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" distPath "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./paths'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'bundle.[contentHash:8].js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 打包代码时，加上 hash 戳,内容改变hash才会变"),(0,t.Uk)("\n        path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 图片 - 考虑 base64 编码的情况"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'url-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    options"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 小于 5kb 的图片用 base64 格式产出"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 否则，依然延用 file-loader 的形式，产出 url 格式"),(0,t.Uk)("\n                        limit"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"5"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"*"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1024"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 打包到 img 目录下"),(0,t.Uk)("\n                        outputPath"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'/img1/'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),d=(0,t.Wm)("h4",{id:"postcss-loader",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#postcss-loader","aria-hidden":"true"},"#"),(0,t.Uk)(" postcss-loader")],-1),g=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 依赖autoprefixer"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 需要添加 postcss.config.js文件"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" autoprefixer "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'autoprefixer'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" pxtorem "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'postcss-pxtorem'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function-variable function"},"exports"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" file "),(0,t.Wm)("span",{class:"token punctuation"},"}")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" remUnit\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" file"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("dirname "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" file"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("dirname"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"indexOf"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'vant'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    remUnit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"37.5"),(0,t.Uk)(" \n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    remUnit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"75"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// rem 换算"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"autoprefixer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 自动加前缀"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token function"},"pxtorem"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rootValue"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" remUnit"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        propList"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'*'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        selectorBlackList"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'van-circle__layer'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])])],-1),h=(0,t.Wm)("h3",{id:"多入口配置entry",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#多入口配置entry","aria-hidden":"true"},"#"),(0,t.Uk)(" 多入口配置entry")],-1),x=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"一个项目中保存了多个 HTML 模版，不同的模版有不同的入口，并且有各自的 router、store 等；"),(0,t.Wm)("li",null,"不仅可以打包出不同 HTML，而且开发的时候也可以顺利进行调试；"),(0,t.Wm)("li",null,"不同入口的文件可以引用同一份组件、图片等资源，也可以引用不同的资源；")])],-1),b=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// webpack.common.js"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" HtmlWebpackPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'html-webpack-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 多页面，在entry入口出需要建多个"),(0,t.Uk)("\n        index"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        other"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// new HtmlWebpackPlugin({"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     template: path.join(srcPath, 'index.html'),"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     filename: 'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 index.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 只引用 index.js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 other.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'other'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 只引用 other.js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.prod.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// filename: 'bundle.[contentHash:8].js',  // 打包代码时，加上 hash 戳"),(0,t.Uk)("\n        filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].[contentHash:8].js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// name 即多入口时 entry 的 key"),(0,t.Uk)("\n        path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'  // 修改所有静态文件 url 的前缀（如 cdn 域名），这里暂时用不到"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])])],-1),w=(0,t.Wm)("h3",{id:"css抽离",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#css抽离","aria-hidden":"true"},"#"),(0,t.Uk)(" CSS抽离")],-1),f=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,[(0,t.Uk)("原本打包过后是css-in-js,在开发环境中使用HMR,style-loader会在页面中创建很多"),(0,t.Wm)("code",null,"<style>"),(0,t.Uk)("标签,增加js体积,配置完"),(0,t.Wm)("code",null,"MiniCssExtractPlugin后"),(0,t.Uk)(",可以将css单独打包出来"),(0,t.Wm)("code",null,"MiniCssExtractPlugin"),(0,t.Uk)("这个插件应该只在生产环境构建中使用，并且在loader链中不应该有style-loader,抽离之后可以相互引用。")])],-1),y=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" MiniCssExtractPlugin "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'mini-css-extract-plugin'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 图片 - 考虑 base64 编码的情况"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.(png|jpg|jpeg|gif)$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'url-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    options"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 小于 5kb 的图片用 base64 格式产出"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 否则，依然延用 file-loader 的形式，产出 url 格式"),(0,t.Uk)("\n                        limit"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"5"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"*"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1024"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 打包到 img 目录下"),(0,t.Uk)("\n                        outputPath"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'/img1/'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                        "),(0,t.Wm)("span",{class:"token comment"},"// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）"),(0,t.Uk)("\n                        "),(0,t.Wm)("span",{class:"token comment"},"// publicPath: 'http://cdn.abc.com'"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 css"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n                    MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 注意，这里不再用 style-loader"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 less --\x3e css"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.less$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                loader"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n                    MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("loader"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 注意，这里不再用 style-loader"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'css-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'less-loader'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token string"},"'postcss-loader'"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 会默认清空 output.path 文件夹"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefinePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token comment"},"// window.ENV = 'production'"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token constant"},"ENV"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n      "),(0,t.Wm)("span",{class:"token comment"},"// 抽离 css 文件"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"MiniCssExtractPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'css/main.[contentHash:8].css'"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    optimization"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 压缩 css、js"),(0,t.Uk)("\n      minimizer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TerserJSPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"OptimizeCSSAssetsPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])])],-1),j=(0,t.Wm)("h3",{id:"抽离公共代码-splitchunks",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#抽离公共代码-splitchunks","aria-hidden":"true"},"#"),(0,t.Uk)(" 抽离公共代码(splitChunks)")],-1),v=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"某块业务代码被多个入口引用，抽离出来，放到一个公共模块中。这样不管这个模块被多少个入口引用，都只会在最终打包结果中出现一次解决代码冗余。"),(0,t.Wm)("li",null,"第三方库一般很大，而且代码基本不会再改动,我会把一些特别大的库分别独立打包，(抽离后不会因为业务代码改变，而导致库hash值也变)，剩下的加起来如果还很大，就把它按照一定大小切割成若干模块。")])],-1),P=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// prod.common.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"smart"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("webpackCommonConf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    mode"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'production'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    optimization"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 压缩 css"),(0,t.Uk)("\n        minimizer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TerserJSPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"OptimizeCSSAssetsPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 分割代码块"),(0,t.Uk)("\n        splitChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'all'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token doc-comment comment"},"/**\n             * initial 入口 chunk，对于异步导入的文件不处理\n                async 异步 chunk，只对异步导入的文件处理\n                all 全部 chunk\n             */"),(0,t.Uk)("\n\n            "),(0,t.Wm)("span",{class:"token comment"},"// 缓存分组"),(0,t.Uk)("\n            cacheGroups"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 第三方模块"),(0,t.Uk)("\n                vendor"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'vendor'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// chunk 名称"),(0,t.Uk)("\n                    priority"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 权限更高，优先抽离，重要！！！"),(0,t.Uk)("\n                    test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"node_modules"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 命中第三方模块"),(0,t.Uk)("\n                    minSize"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 大小限制"),(0,t.Uk)("\n                    minChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 最少复用过几次"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n                "),(0,t.Wm)("span",{class:"token comment"},"// 公共的模块"),(0,t.Uk)("\n                common"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// chunk 名称"),(0,t.Uk)("\n                    priority"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 优先级"),(0,t.Uk)("\n                    minSize"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 公共模块的大小限制(如果太小就没必要单独打包了)"),(0,t.Uk)("\n                    minChunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 公共模块最少复用过几次"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.common.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// new HtmlWebpackPlugin({"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     template: path.join(srcPath, 'index.html'),"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"//     filename: 'index.html'"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 index.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'index.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用"),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'index'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'vendor'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 要考虑代码分割"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 多入口 - 生成 other.html"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'other.html'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            chunks"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'other'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'common'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 考虑代码分割"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// chunks在哪些地方用到"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 1.entry(中可以表示chunks的引用)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 2.splitChunks(也可以定义chunks)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 3.HtmlWebpackPlugin(使用chunks)"),(0,t.Uk)("\n")])])],-1),C=(0,t.Wm)("h3",{id:"懒加载",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#懒加载","aria-hidden":"true"},"#"),(0,t.Uk)(" 懒加载")],-1),S=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// export default {"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//   message: 'this is data'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 引入动态数据 - 懒加载"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"setTimeout"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 回顾vue、react异步组件都是用的这个语法，是js的语法"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 异步加载也是定义一个chunk"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./data.js'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"then"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"res"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("default"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("message"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 主力这里的defalut"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function-variable function"},"List"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token comment"},'/* webpackChunkName: "home" */'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./List.vue'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])])],-1),H=(0,t.Wm)("h3",{id:"处理jsx和vue",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理jsx和vue","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理JSX和VUE")],-1),q=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// React"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm install --save-dev @babel/preset-react"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// .babelrc文件中配置"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"presets"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"@babel/preset-react"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"plugins"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// Vue直接只用vue-loader"),(0,t.Uk)("\n")])])],-1),E=(0,t.Wm)("h3",{id:"module-chunk-bundle-的区别",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#module-chunk-bundle-的区别","aria-hidden":"true"},"#"),(0,t.Uk)(" module chunk bundle 的区别")],-1),_=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:o,alt:"module chunk bundle"})],-1),D=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"module: 各个源码文件，webpack中的一切皆模块(js、img、css、sass...)"),(0,t.Wm)("li",null,"chunk: 多个模块合并成的,如 entry 、import()、 splitChunk"),(0,t.Wm)("li",null,"bundle: webpack 处理好 chunk 文件后，最后会输出 bundle 文件，这个 bundle 文件包含了经过加载和编译的最终源文件，所以它可以直接在浏览器中运行。")]),(0,t.Wm)("p",null,"module、chunk 和 bundle 其实就是同一份逻辑代码在不同转换场景下的取了三个名字： 我们直接写出来的是 module，webpack 处理时是 chunk，最后生成浏览器可以直接运行的 bundle。")],-1),N=(0,t.Wm)("h3",{id:"webpack-性能优化",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#webpack-性能优化","aria-hidden":"true"},"#"),(0,t.Uk)(" webpack 性能优化")],-1),T=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"优化打包构建速度 - 开发体验和效率"),(0,t.Wm)("li",null,"优化产出代码 - 产品性能")])],-1),J=(0,t.Wm)("h4",{id:"优化打包构建速度",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#优化打包构建速度","aria-hidden":"true"},"#"),(0,t.Uk)(" 优化打包构建速度")],-1),M=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"Loader"),(0,t.Uk)("优化配置 【dev】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"IgnorePlugin"),(0,t.Uk)(" (忽略第三方包指定目录，让这些指定目录(如moment的语言包)不要被打包进去)【prod】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"noParse"),(0,t.Uk)(" 不去解析属性值代表的库的依赖(jquery) 【prod】")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"happyPack"),(0,t.Uk)(" 开启多个进程去打包(按需开启)，提高构建速度（特别是多核CPU） "),(0,t.Wm)("code",null,"ParallelUglifyPlugin"),(0,t.Uk)(" webpack内置Uglify工具压缩JS,但是是单线程，"),(0,t.Wm)("code",null,"ParallelUglifyPlugin"),(0,t.Uk)(" 是多进程压更快，和"),(0,t.Wm)("code",null,"happyPack"),(0,t.Uk)("同理 【prod】")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"项目较大，打包较慢，开启多进程能提高速度"),(0,t.Wm)("li",null,"项目较小，打包很快，开启多进程会降低速度（进程多了，进程开启、销毁、通信），欲速则不达")]),(0,t.Wm)("ol",{start:"5"},[(0,t.Wm)("li",null,"热更新 模块热替换，解决页面刷新导致的状态丢失问题。【dev】"),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"DllPlugin"),(0,t.Uk)(" 我们的代码都可以至少简单区分成业务代码和第三方库。大部分第三方库框架如Vue React体积大，比较稳定、不常升级,构建慢。使用DllPlugin 动态库就不需要重新打包，每次构建只重新打包业务代码。【dev】")])])],-1),L=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,[(0,t.Uk)("1. 优化"),(0,t.Wm)("code",null,"Loader"),(0,t.Uk)("配置")])],-1),V=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// Loader处理文件的转换操作是很耗时的，所以需要让尽可能少的文件被Loader处理"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token string"},"'babel-loader?cacheDirectory'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//开启转换结果缓存(加上cacheDirectory参数后，启用缓存之后，如ES6没有改的就不会重新编译)"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'src'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//只对src目录中文件采用babel-loader"),(0,t.Uk)("\n    exclude"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token string"},"' ./node_modules'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//排除node_modules目录下的文件"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// include或者exclude确定范围，提升速度"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),I=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"2. IgnorePlugin")],-1),R=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 忽略第三方包指定目录，让这些指定目录不要被打包进去"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 当我们使用moment,是一个时间工具包，内部里面把所有的语言包都引入；"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 我们可以控制解析改包时，可以忽略调引入的文件。"),(0,t.Uk)("\nplugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"//weback自带的插件 忽略"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("webpack"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("IgnorePlugin")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.\\/locale"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"moment"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token comment"},"//优化3   如果引入这个moment包时 会忽略调 locale文件"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        template"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token string"},'"./public/index.html"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//我们要手动引入需要的语言包"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//手动引入中文包"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'// import "moment/locale/zh-cn";'),(0,t.Uk)("\n")])])],-1),z=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"3. noParse")],-1),$=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 不去解析属性值代表的库的依赖,webpack精准过滤不需要解析的文件."),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 当解析jq的时候,会去解析jq这个库是否有依赖其他的包,我们对类似jq这类依赖库，"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 一般会认为不会引用其他的包(特殊除外,自行判断)。所以，对于这类不引用其他的"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 包的库，我们在打包的时候就没有必要去解析，这样能够增加打包速率。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 可以在webpack的module配置中增加noParse属性（以下代码只需要看module的noParse属性）"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    module"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        noParse"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"jquery|lodash"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"//接收参数  正则表达式 或函数"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token function-variable function"},"noParse"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"contentPath"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"jquery|lodash"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"test"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("contentPath"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])])],-1),O=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"4. happyPack 和 ParallelUglifyPlugin")],-1),B=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// JS 单线程 =>nodeJS单线程=> webpack也是单线程，但是可以开启多个进程去打包，提高构建速度(特别是多核CPU)"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack内置Uglify工具压缩JS,但是是单线程，使用ParallelUglifyPlugin` 是多进程压更快，和`happyPack`同理"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm i -D happypack"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    rules"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// js"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token regex"},[(0,t.Wm)("span",{class:"token regex-delimiter"},"/"),(0,t.Wm)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,t.Wm)("span",{class:"token regex-delimiter"},"/")]),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 把对 .js 文件的处理转交给 id 为 babel 的 HappyPack 实例"),(0,t.Uk)("\n            use"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'happypack/loader?id=babel'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            include"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" srcPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// exclude: /node_modules/"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nplugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// happyPack 开启多进程打包"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"HappyPack"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 用唯一的标识符 id 来代表当前的 HappyPack 是用来处理一类特定的文件"),(0,t.Uk)("\n        id"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'babel'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 如何处理 .js 文件，用法和 Loader 配置中一样"),(0,t.Uk)("\n        loaders"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'babel-loader?cacheDirectory'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"ParallelUglifyPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 传递给 UglifyJS 的参数"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// （还是使用 UglifyJS 压缩，只不过帮助开启了多进程）"),(0,t.Uk)("\n        uglifyJS"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                beautify"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 最紧凑的输出"),(0,t.Uk)("\n                comments"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 删除所有的注释"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 删除所有的 `console` 语句，可以兼容ie浏览器"),(0,t.Uk)("\n                drop_console"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 内嵌定义了但是只用到一次的变量"),(0,t.Uk)("\n                collapse_vars"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token comment"},"// 提取出出现多次但是没有定义成变量去引用的静态值"),(0,t.Uk)("\n                reduce_vars"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n")])])],-1),A=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"5. 热更新"),(0,t.Wm)("img",{src:e,alt:"热更新"})],-1),X=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,"发展历史 保存后自动编译（Auto Compile） => 自动刷新浏览器（Live Reload） => HMR（Hot Module Replacement，模块热替换）"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"手动："),(0,t.Uk)(" 最早一切依赖手动，修改代码后需要手动执行"),(0,t.Wm)("code",null,"npm run build:xxx"),(0,t.Uk)(", 然后刷新页面。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Watch："),(0,t.Uk)(" 早期使用"),(0,t.Wm)("code",null,"gulp"),(0,t.Uk)("或者"),(0,t.Wm)("code",null,"webpack"),(0,t.Uk)("配置"),(0,t.Wm)("code",null,"Watch"),(0,t.Uk)("模式，通过监控源码文件的变化来解决上面不能自动编译。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Live Reload："),(0,t.Uk)(" 每次代码变更后浏览器中的预览页面能自动显示最新效果而无须手动点击刷新，我们需要一种通信机制来连接浏览器中的预览页面与本地监控代码变更的进程 "),(0,t.Wm)("strong",null,"缺点："),(0,t.Uk)(" 整个网页刷新，速度较慢,状态会丢失(如：表单输入、弹框打开消失、颜色样式)")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"Hot Module Replacement"),(0,t.Uk)(" 模块热替换，解决页面刷新导致的状态丢失问题。")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"CSS:"),(0,t.Uk)(" 使用 style-loader 和 css-loader 来解析导入的 CSS 文件。其中 css-loader 处理的是将导入的 CSS 文件转化为模块供后续 Loader 处理；而 style-loader 则是负责将 CSS 模块的内容在运行时添加到页面的 style 标签中。")]),(0,t.Wm)("li",null,[(0,t.Wm)("strong",null,"JS:"),(0,t.Uk)(" 使用hot.accept方法,当文本发生变更时，可以观察到浏览器端显示最新内容的同时并未触发页面刷新。vue-loader、 react-hot-loader 等加载器也都实现了该功能。")])])],-1),G=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// webpack中的配置"),(0,t.Uk)("\ndevServer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    port"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"8080"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    progress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 显示打包的进度条"),(0,t.Uk)("\n    contentBase"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" distPath"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 根目录"),(0,t.Uk)("\n    open"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 自动打开浏览器"),(0,t.Uk)("\n    compress"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("  "),(0,t.Wm)("span",{class:"token comment"},"// 启动 gzip 压缩"),(0,t.Uk)("\n    hot"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 设置代理"),(0,t.Uk)("\n    proxy"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// JS 代码中的热替换"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// ./text.js "),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Hello World'"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token comment"},"// ./index2.js "),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'./text.js'"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" div "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" document"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createElement"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'div'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \ndocument"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"appendChild"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n  div"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("innerHTML "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hot"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 如果开启热更新"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 监听 xxx.js范围之内才热更新"),(0,t.Uk)("\n  module"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("hot"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"accept"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'./text.js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n    "),(0,t.Wm)("span",{class:"token function"},"render"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])])],-1),Y=(0,t.Wm)("ol",{start:"6"},[(0,t.Wm)("li",null,"DllPlugin动态链接库插件")],-1),F=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("p",null,"我们的代码都可以至少简单区分成业务代码和第三方库。大部分第三方库框架如Vue React体积大，比较稳定、不常升级,构建慢。使用DllPlugin 动态库就不需要重新打包，每次构建只重新打包业务代码。 用webpack已内置DllPlugin, 打包出dll文件，DllReferencePlugin 使用dll文件")],-1),K=(0,t.Wm)("div",{class:"language-javascript ext-js"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// package.json"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// {"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'//   "scripts": {'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},'//     "dll": "webpack --config webpack.dll.config"'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"//  }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// npm run dll"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// webpack.dll.config.js"),(0,t.Uk)("\nmodule"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  entry"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 把React 相关的模块放到一个单独的攻台链接库"),(0,t.Uk)("\n    react"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react-dom'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react-redux'"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  output"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 输出的动态链接库的文件名称，[name] 代表当前动态链接库的名称"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 也就是entry中配置的 react 和 polyfill"),(0,t.Uk)("\n    filename"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].dll.js'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"//  输出的文件都放在dist 目录下"),(0,t.Uk)("\n    path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'dist/dll'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// library必须和后面dllplugin中的name一致 后面会说明"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 只所有加_dll_是为了防止全局变量冲突"),(0,t.Uk)("\n    library"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name]_dll_[hash]'"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  plugins"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 接入 DllPlugin"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"DllPlugin"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 动态链接库的全局变量名称，需要和 output.library 中保持一致"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 该字段的值也就是输出的 manifest.json 文件 中 name 字段的值"),(0,t.Uk)("\n      name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name]_dll_[hash]'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token comment"},"// 描述动态链接库的 manifest.json 文件输出时的文件名称"),(0,t.Uk)("\n      path"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'dist/dll'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'[name].manifest.json'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 在入口文件引入dll文件"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("script src"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token string"},'"../../dist/dll/react.dll.js"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("script"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n")])])],-1),Q=(0,t.Wm)("h4",{id:"优化产出代码",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#优化产出代码","aria-hidden":"true"},"#"),(0,t.Uk)(" 优化产出代码")],-1),Z=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"TIP"),(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Uk)("小图片"),(0,t.Wm)("code",null,"base64"),(0,t.Uk)("编码，减少网络请求")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"bundle"),(0,t.Uk)("加"),(0,t.Wm)("code",null,"hash"),(0,t.Uk)(",文件没有修改 hash不变，能被浏览器缓存命中")]),(0,t.Wm)("li",null,[(0,t.Uk)("懒加载，通过"),(0,t.Wm)("code",null,"import")]),(0,t.Wm)("li",null,"splitChunks 提取公共代码，重复引用，解决代码冗余。"),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"IgnorePlugin"),(0,t.Uk)(" (忽略第三方包指定目录，让这些指定目录(如moment的语言包)不要被打包进去)【prod】")]),(0,t.Wm)("li",null,[(0,t.Uk)("使用CDN加速 "),(0,t.Wm)("code",null,"publicPath"),(0,t.Uk)(" 配置CDN路径")]),(0,t.Wm)("li",null,[(0,t.Uk)("使用"),(0,t.Wm)("code",null,"production"),(0,t.Uk)(" 配置环境变量(接口域名、sourceMap、代码压缩)")]),(0,t.Wm)("li",null,"Scope Hosting"),(0,t.Wm)("li",null,[(0,t.Uk)("启动"),(0,t.Wm)("code",null,"Tree-Shaking"),(0,t.Uk)("(主要功能就是去除没有用到代码,必须用 ES6 Module 才能Tree-Shaking 生效, commonjs就不行, webpack中已经默认开启Tree-Shaking)")])]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"体积更小"),(0,t.Wm)("li",null,"合理分包，不重复加载"),(0,t.Wm)("li",null,"速度更快，内存使用更少")])],-1),nn=(0,t.Wm)("h3",{id:"es6-module-和-commonjs-区别",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#es6-module-和-commonjs-区别","aria-hidden":"true"},"#"),(0,t.Uk)(" ES6 Module 和 Commonjs 区别")],-1),sn={render:function(n,s){return(0,t.wg)(),(0,t.j4)(t.HY,null,[c,p,k,l,m,u,W,i,r,U,d,g,h,x,b,w,f,y,j,v,P,C,S,H,q,E,_,D,N,T,J,M,L,V,I,R,z,$,O,B,A,X,G,Y,F,K,Q,Z,nn],64)}}}}]);